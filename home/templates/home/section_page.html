{% extends "base.html" %}
{% load wagtailcore_tags %}
{% block title %}{{ self.seo_title|default:self.title }}{% endblock %}
{% block extra_head %}
    {{ block.super }}
    <style>
  .section-card {
    border: 1px solid #b1b4b6;
    padding: 20px;
    height: 100%;
  }

  .section-card__text p:last-child {
    margin-bottom: 0;
  }
    </style>
{% endblock %}
{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
            <h1 class="govuk-heading-xl">{{ self.hero_title|default:self.title }}</h1>
            {% if self.search_description %}<p class="govuk-body-l">{{ self.search_description }}</p>{% endif %}
            {% if self.hero_intro %}<div class="govuk-body-l rich-text-content">{{ self.hero_intro|richtext }}</div>{% endif %}
        </div>
    </div>
    {% for row in self.rows %}
        {% if row.block_type == "row" %}
            <div class="govuk-grid-row govuk-!-margin-bottom-8">
                <div class="govuk-grid-column-full">
                    {% if row.value.heading %}<h2 class="govuk-heading-m">{{ row.value.heading }}</h2>{% endif %}
                    <div class="govuk-grid-row">
                        {% with card_count=row.value.cards|length %}
                            {% for card in row.value.cards %}
                                <div class="{% if card_count == 1 %}govuk-grid-column-full{% elif card_count == 2 %}govuk-grid-column-one-half{% else %}govuk-grid-column-one-third{% endif %}">
                                    <div class="section-card govuk-!-margin-bottom-4">
                                        <h3 class="govuk-heading-s">
                                            {% if card.link_url %}
                                                <a class="govuk-link govuk-link--no-underline govuk-link--no-visited-state"
                                                   href="{{ card.link_url }}">{{ card.title }}</a>
                                            {% else %}
                                                {{ card.title }}
                                            {% endif %}
                                        </h3>
                                        {% if card.text %}<div class="govuk-body section-card__text">{{ card.text|richtext }}</div>{% endif %}
                                        {% if card.link_text and card.link_url %}
                                            <a href="{{ card.link_url }}"
                                               role="button"
                                               draggable="false"
                                               class="govuk-button govuk-!-margin-bottom-2"
                                               data-module="govuk-button">{{ card.link_text }}</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endwith %}
                    </div>
                </div>
            </div>
        {% endif %}
    {% endfor %}
    {% if self.free_text %}
        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">
                <div class="govuk-body rich-text-content">{{ self.free_text|richtext }}</div>
            </div>
        </div>
    {% endif %}
    {% if request.user.is_authenticated and perms.wagtailadmin.access_admin %}
        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <p class="govuk-body">
            <a class="govuk-link" href="/admin/pages/{{ self.id }}/edit/">Edit this page</a>
        </p>
    {% endif %}
{% endblock %}
